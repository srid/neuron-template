name: "Publish"
on:
  # Run only when pushing to master branch
  push:
    branches:
      - master
jobs:
  # By default, your notes are compiled using the docker (Linux). If your notes were written using a Macos platform
  # and shows some special characters in the filenames (such as Ã©,Ã¨, Â§), comment-out neuron-docker and uncomment neuron-macos
  # Warning:
  neuron-docker:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Build neuron site ðŸ”§
      run: |
        mkdir -p .neuron/output && touch .neuron/output/.nojekyll
        docker run -v $PWD:/notes sridca/neuron neuron gen --pretty-urls
    - name: Deploy to gh-pages ðŸš€
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: .neuron/output/
  # neuron-macos:
  #   runs-on: ${{ matrix.os }}
  #   strategy:
  #     matrix:
  #       os: [macos-latest]
  #   steps:
  #     - uses: actions/checkout@v2
  #     - uses: cachix/install-nix-action@v12
  #     # This also runs nix-build.
  #     - uses: cachix/cachix-action@v8
  #       with:
  #         name: srid
  #         signingKey: "${{ secrets.CACHIX_SIGNING_KEY }}"
  #         # Only needed for private caches
  #         authToken: "${{ secrets.CACHIX_AUTH_TOKEN }}"
  #     # This downloads deps from Nix cache, builds neuron, as well as run tests
  #     - name: Build ðŸ”§
  #       run: |
  #         nix-env -if https://github.com/srid/neuron/archive/master.tar.gz
  #     - name: Compile
  #       run: |
  #         neuron gen --pretty-urls
  #     - name: Deploy to gh-pages ðŸš€
  #       uses: peaceiris/actions-gh-pages@v3
  #       with:
  #         github_token: ${{ secrets.GITHUB_TOKEN }}
  #         publish_dir: .neuron/output
